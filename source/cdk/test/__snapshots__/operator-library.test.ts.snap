// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Snapshot operator-library stack test 1`] = `
{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Conditions": {
    "AllowAccessToExternalBucket": {
      "Fn::Not": [
        {
          "Fn::Equals": [
            {
              "Ref": "ExternalBucketArn",
            },
            "",
          ],
        },
      ],
    },
  },
  "Description": "media-insights-on-aws. This AWS CloudFormation template provisions the Media Insights on AWS operator library. Version %%VERSION%%",
  "Mappings": {
    "SourceCode": {
      "General": {
        "CodeKeyPrefix": "media-insights-on-aws/%%VERSION%%",
        "RegionalS3Bucket": "%%REGIONAL_BUCKET_NAME%%",
      },
    },
  },
  "Outputs": {
    "CelebRecognition": {
      "Description": "CelebRecognition operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "CelebRecognition",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "celebrityRecognitionOperation",
          "Name",
        ],
      },
    },
    "CelebrityRecognitionOperationImage": {
      "Description": "CelebRecognition image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "CelebRecognitionImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "celebrityRecognitionOperationImage",
          "Name",
        ],
      },
    },
    "ContentModeration": {
      "Description": "Content moderation operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "ContentModeration",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "contentModerationOperation",
          "Name",
        ],
      },
    },
    "ContentModerationOperationImage": {
      "Description": "Content moderation image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "ContentModerationImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "contentModerationOperationImage",
          "Name",
        ],
      },
    },
    "CreateSRTCaptionsOperation": {
      "Description": "Operation to create SRT captions",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "CreateSRTCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "CreateSRTCaptionsOperation",
          "Name",
        ],
      },
    },
    "CreateVTTCaptionsOperation": {
      "Description": "Operation to create VTT captions",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "CreateVTTCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "CreateVTTCaptionsOperation",
          "Name",
        ],
      },
    },
    "FaceDetection": {
      "Description": "Face detection operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "FaceDetection",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "faceDetectionOperation",
          "Name",
        ],
      },
    },
    "FaceDetectionOperationImage": {
      "Description": "Face detection image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "FaceDetectionImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "faceDetectionOperationImage",
          "Name",
        ],
      },
    },
    "FaceSearch": {
      "Description": "Face search operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "FaceSearch",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "faceSearchOperation",
          "Name",
        ],
      },
    },
    "FaceSearchOperationImage": {
      "Description": "Face search image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "FaceSearchImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "faceSearchOperationImage",
          "Name",
        ],
      },
    },
    "GenericDataLookupOperation": {
      "Description": "Operation name of GenericDataLookup",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "GenericDataLookup",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "GenericDataLookupOperation",
          "Name",
        ],
      },
    },
    "LabelDetection": {
      "Description": "Label detection operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "LabelDetection",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "labelDetectionOperation",
          "Name",
        ],
      },
    },
    "LabelDetectionOperationImage": {
      "Description": "CelebRecognition image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "LabelDetectionImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "labelDetectionOperationImage",
          "Name",
        ],
      },
    },
    "MediaconvertOperation": {
      "Description": "Operation name of mediaconvert",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Mediaconvert",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "MediaconvertOperation",
          "Name",
        ],
      },
    },
    "MediainfoOperation": {
      "Description": "Operation name of Mediainfo",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Mediainfo",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "MediainfoOperation",
          "Name",
        ],
      },
    },
    "MediainfoOperationImage": {
      "Description": "Operation name of MediainfoImage",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "MediainfoImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "MediainfoOperationImage",
          "Name",
        ],
      },
    },
    "PersonTracking": {
      "Description": "Person tracking",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "PersonTracking",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "personTrackingOperation",
          "Name",
        ],
      },
    },
    "PollyOperation": {
      "Description": "Operation name of polly",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Polly",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "PollyOperation",
          "Name",
        ],
      },
    },
    "PollyWebCaptionsOperation": {
      "Description": "Operation to create audio tracks from webcaptions collection transcripts",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "PollyWebCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "PollyWebCaptionsOperation",
          "Name",
        ],
      },
    },
    "TechnicalCueDetection": {
      "Description": "technicalCueDetection operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TechnicalCueDetection",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "technicalCueDetectionOperation",
          "Name",
        ],
      },
    },
    "TextDetection": {
      "Description": "Text detection operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TextDetection",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "textDetectionOperation",
          "Name",
        ],
      },
    },
    "TextDetectionOperationImage": {
      "Description": "Text Detection image operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TextDetectionImage",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "textDetectionOperationImage",
          "Name",
        ],
      },
    },
    "ThumbnailOperation": {
      "Description": "Operation name of thumbnail",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Thumbnail",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "ThumbnailOperation",
          "Name",
        ],
      },
    },
    "TranscribeAudioOperation": {
      "Description": "Operation name of transcribe for audio",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TranscribeAudio",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "TranscribeAudioOperation",
          "Name",
        ],
      },
    },
    "TranscribeVideoOperation": {
      "Description": "Operation name of transcribe for video",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TranscribeVideo",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "TranscribeVideoOperation",
          "Name",
        ],
      },
    },
    "TranslateOperation": {
      "Description": "Operation name of translate",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Translate",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "TranslateOperation",
          "Name",
        ],
      },
    },
    "TranslateWebCaptionsOperation": {
      "Description": "Operation name of translate WebCaptions",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "TranslateWebCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "TranslateWebCaptionsOperation",
          "Name",
        ],
      },
    },
    "WaitOperation": {
      "Description": "Wait operator - wait until /workflow/execution/continue API is called",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "Wait",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "WaitOperation",
          "Name",
        ],
      },
    },
    "WebCaptionsOperation": {
      "Description": "Operation to create web captions",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "WebCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "WebCaptionsOperation",
          "Name",
        ],
      },
    },
    "WebToSRTCaptionsOperation": {
      "Description": "Operation to convert web captions to SRT format",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "WebToSRTCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "WebToSRTCaptionsOperation",
          "Name",
        ],
      },
    },
    "WebToVTTCaptionsOperation": {
      "Description": "Operation to convert web captions to VTT format",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "WebToVTTCaptions",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "WebToVTTCaptionsOperation",
          "Name",
        ],
      },
    },
    "comprehendEntitiesOperation": {
      "Description": "Operation name of polly",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "ComprehendEntities",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "comprehendEntitiesOperation",
          "Name",
        ],
      },
    },
    "comprehendPhrasesOperation": {
      "Description": "Operation name of polly",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "ComprehendPhrases",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "comprehendPhrasesOperation",
          "Name",
        ],
      },
    },
    "shotDetection": {
      "Description": "shotDetection operator",
      "Export": {
        "Name": {
          "Fn::Join": [
            ":",
            [
              {
                "Ref": "AWS::StackName",
              },
              "ShotDetection",
            ],
          ],
        },
      },
      "Value": {
        "Fn::GetAtt": [
          "shotDetectionOperation",
          "Name",
        ],
      },
    },
  },
  "Parameters": {
    "Boto3UserAgent": {
      "Description": "Boto3 user agent string",
      "Type": "String",
    },
    "CheckWaitOperationLambda": {
      "Description": "ARN of control plane lambda function to if a workflow is in Waiting state",
      "Type": "String",
    },
    "DataPlaneBucket": {
      "Description": "Bucket for the dataplane",
      "Type": "String",
    },
    "DataPlaneEndpoint": {
      "Description": "Name of the dataplane handler lambda function",
      "Type": "String",
    },
    "DataPlaneHandlerArn": {
      "Description": "Arn of dataplane lambda handler",
      "Type": "String",
    },
    "ExternalBucketArn": {
      "Description": "The ARN for Amazon S3 resources that exist outside the stack which may need to be used as inputs to the workflows",
      "Type": "String",
    },
    "MediaConvertEndpoint": {
      "Description": "Account-specific endpoint URL for MediaConvert",
      "Type": "String",
    },
    "StartWaitOperationLambda": {
      "Description": "ARN of control plane lambda function to set a workflow to Waiting state",
      "Type": "String",
    },
    "WorkflowCustomResourceArn": {
      "Description": "ARN of the Media insights on AWS custom resource that handles creating operations, stages and workflows",
      "Type": "String",
    },
    "referencetoMiTestStackMediaInsightsOnAwsPython311Layer": {
      "Type": "String",
    },
    "referencetoMiTestStackMieKey": {
      "Type": "String",
    },
    "referencetoMiTestStackMieKeyArn": {
      "Type": "String",
    },
  },
  "Resources": {
    "CheckMediaConvertFunction": {
      "DependsOn": [
        "mediaConvertLambdaRoleDefaultPolicy",
        "mediaConvertLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "get_media_convert.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "MEDIACONVERT_ENDPOINT": {
              "Ref": "MediaConvertEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "get_media_convert.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "mediaConvertLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 60,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CheckPollyFunction": {
      "DependsOn": [
        "pollyRoleDefaultPolicy",
        "pollyRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "get_polly.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "get_polly.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "pollyRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CheckPollyWebCaptionsFunction": {
      "DependsOn": [
        "pollyRoleDefaultPolicy",
        "pollyRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.check_polly_webcaptions",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "pollyRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CheckThumbnailFunction": {
      "DependsOn": [
        "mediaConvertLambdaRoleDefaultPolicy",
        "mediaConvertLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_thumbnail.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "MEDIACONVERT_ENDPOINT": {
              "Ref": "MediaConvertEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "mediaconvertRole": {
              "Fn::GetAtt": [
                "mediaConvertS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "check_thumbnail.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "mediaConvertLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 60,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CheckTranscribeFunction": {
      "DependsOn": [
        "transcribeRoleDefaultPolicy",
        "transcribeRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "get_transcribe.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "get_transcribe.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "transcribeRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CheckTranslateWebcaptionsFunction": {
      "DependsOn": [
        "translateRoleDefaultPolicy",
        "translateRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.check_translate_webcaptions",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "translateRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CreateSRTCaptionsFunction": {
      "DependsOn": [
        "captionsRoleDefaultPolicy",
        "captionsRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.create_srt",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "captionsRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CreateSRTCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Text",
        },
        "Name": "CreateSRTCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "CreateSRTCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "CreateVTTCaptionsFunction": {
      "DependsOn": [
        "captionsRoleDefaultPolicy",
        "captionsRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.create_vtt",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "captionsRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "CreateVTTCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Text",
        },
        "Name": "CreateVTTCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "CreateVTTCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "GenericDataLookupOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": false,
          "MediaType": "Video",
        },
        "Name": "GenericDataLookup",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startGenericDataLookup",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "MediaconvertOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckMediaConvertFunction",
            "Arn",
          ],
        },
        "Name": "Mediaconvert",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartMediaConvertFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "Mediainfo": {
      "DependsOn": [
        "mediainfoLambdaRoleDefaultPolicy",
        "mediainfoLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
            {
              "id": "AwsSolutions-L1",
              "reason": "The version of pymediainfo does not support latest runtime version",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "mediainfo.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataLookupRole": {
              "Fn::GetAtt": [
                "mediainfoLambdaRole",
                "Arn",
              ],
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "LD_LIBRARY_PATH": "/opt/python/",
            "OPERATOR_NAME": "Mediainfo",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "mediainfo.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "mediainfoLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "MediainfoOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "Name": "Mediainfo",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "Mediainfo",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "MediainfoOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "MediainfoImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "Mediainfo",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "PollyOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": false,
          "MediaType": "Text",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckPollyFunction",
            "Arn",
          ],
        },
        "Name": "Polly",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartPollyFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "PollyWebCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "MetadataOnly",
          "SourceLanguageCode": "en",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckPollyWebCaptionsFunction",
            "Arn",
          ],
        },
        "Name": "PollyWebCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartPollyWebCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "StartMediaConvertFunction": {
      "DependsOn": [
        "mediaConvertLambdaRoleDefaultPolicy",
        "mediaConvertLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_media_convert.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "MEDIACONVERT_ENDPOINT": {
              "Ref": "MediaConvertEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "mediaconvertRole": {
              "Fn::GetAtt": [
                "mediaConvertS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "start_media_convert.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "mediaConvertLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 60,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "StartPollyFunction": {
      "DependsOn": [
        "pollyRoleDefaultPolicy",
        "pollyRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_polly.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_polly.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "pollyRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "StartPollyWebCaptionsFunction": {
      "DependsOn": [
        "pollyRoleDefaultPolicy",
        "pollyRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.start_polly_webcaptions",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "pollyRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "StartThumbnailFunction": {
      "DependsOn": [
        "mediaConvertLambdaRoleDefaultPolicy",
        "mediaConvertLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_thumbnail.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "MEDIACONVERT_ENDPOINT": {
              "Ref": "MediaConvertEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "mediaconvertRole": {
              "Fn::GetAtt": [
                "mediaConvertS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "start_thumbnail.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "mediaConvertLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 60,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "StartTranscribeFunction": {
      "DependsOn": [
        "transcribeRoleDefaultPolicy",
        "transcribeRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_transcribe.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_transcribe.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "transcribeRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "StartTranslateWebcaptionsFunction": {
      "DependsOn": [
        "translateRoleDefaultPolicy",
        "translateRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "translateRole": {
              "Fn::GetAtt": [
                "translateS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "webcaptions.start_translate_webcaptions",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "translateRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ThumbnailOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckThumbnailFunction",
            "Arn",
          ],
        },
        "Name": "Thumbnail",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartThumbnailFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "TranscribeAudioOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Audio",
          "TranscribeLanguage": "en-US",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckTranscribeFunction",
            "Arn",
          ],
        },
        "Name": "TranscribeAudio",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartTranscribeFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "TranscribeVideoOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
          "TranscribeLanguage": "en-US",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckTranscribeFunction",
            "Arn",
          ],
        },
        "Name": "TranscribeVideo",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartTranscribeFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "TranslateFunction": {
      "DependsOn": [
        "translateRoleDefaultPolicy",
        "translateRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_translate.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_translate.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "translateRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "TranslateOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Text",
          "SourceLanguageCode": "en",
          "TargetLanguageCode": "ru",
        },
        "Name": "Translate",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "TranslateFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "TranslateWebCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "MetadataOnly",
          "SourceLanguageCode": "en",
          "TargetLanguageCodes": [
            "es",
          ],
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "CheckTranslateWebcaptionsFunction",
            "Arn",
          ],
        },
        "Name": "TranslateWebCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "StartTranslateWebcaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "WaitOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": false,
          "MediaType": "MetadataOnly",
        },
        "MonitorLambdaArn": {
          "Ref": "CheckWaitOperationLambda",
        },
        "Name": "Wait",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Ref": "StartWaitOperationLambda",
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "WebCaptionsFunction": {
      "DependsOn": [
        "captionsRoleDefaultPolicy",
        "captionsRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.web_captions",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "captionsRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "WebCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "MetadataOnly",
          "SourceLanguageCode": "en",
        },
        "Name": "WebCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "WebCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "WebToSRTCaptionsFunction": {
      "DependsOn": [
        "captionsRoleDefaultPolicy",
        "captionsRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.create_srt",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "captionsRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "WebToSRTCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "MetadataOnly",
          "TargetLanguageCodes": [
            "en",
          ],
        },
        "Name": "WebToSRTCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "WebToSRTCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "WebToVTTCaptionsFunction": {
      "DependsOn": [
        "captionsRoleDefaultPolicy",
        "captionsRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "webcaptions.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "webcaptions.create_vtt",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "captionsRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "WebToVTTCaptionsOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "MetadataOnly",
          "TargetLanguageCodes": [
            "en",
          ],
        },
        "Name": "WebToVTTCaptions",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "WebToVTTCaptionsFunction",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "captionsRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "CaptionsAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "captionsRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "captionsRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "captionsRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "celebrityRecognitionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkCelebrityRecognition",
            "Arn",
          ],
        },
        "Name": "celebrityRecognition",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startCelebrityRecognition",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "celebrityRecognitionOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "celebrityRecognitionImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startCelebrityRecognition",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "checkCelebrityRecognition": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "celebrityRecognition",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_celebrity_recognition_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkContentModeration": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "contentModeration",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_content_moderation_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkFaceDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "faceDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_face_detection_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 512,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkFaceSearch": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "faceSearch",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_face_search_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkLabelDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "labelDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_label_detection_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 240,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkPersonTracking": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "personTracking",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_person_tracking_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkShotDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "shotDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_shot_detection_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkTechnicalCueDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "technicalCueDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_technical_cue_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "checkTextDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "check_rekognition_status.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "textDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "check_rekognition_status.check_text_detection_status",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 240,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "comprehendEntitiesOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Text",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "getEntityDetection",
            "Arn",
          ],
        },
        "Name": "ComprehendEntities",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startEntityDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "comprehendPhrasesOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Text",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "getKeyPhrases",
            "Arn",
          ],
        },
        "Name": "ComprehendKeyPhrases",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startKeyPhrases",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "comprehendRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "iam:PassRole",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "comprehendS3Role",
                      "Arn",
                    ],
                  },
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": [
                    "comprehend:StartEntitiesDetectionJob",
                    "comprehend:DetectSentiment",
                    "comprehend:DescribeEntityRecognizer",
                    "comprehend:ListTopicsDetectionJobs",
                    "comprehend:DescribeDominantLanguageDetectionJob",
                    "comprehend:StopTrainingEntityRecognizer",
                    "comprehend:DescribeDocumentClassificationJob",
                    "comprehend:StopSentimentDetectionJob",
                    "comprehend:StartDominantLanguageDetectionJob",
                    "comprehend:StartTopicsDetectionJob",
                    "comprehend:DetectDominantLanguage",
                    "comprehend:CreateDocumentClassifier",
                    "comprehend:ListEntityRecognizers",
                    "comprehend:ListSentimentDetectionJobs",
                    "comprehend:BatchDetectSyntax",
                    "comprehend:StartSentimentDetectionJob",
                    "comprehend:ListDominantLanguageDetectionJobs",
                    "comprehend:ListDocumentClassifiers",
                    "comprehend:DescribeKeyPhrasesDetectionJob",
                    "comprehend:CreateEntityRecognizer",
                    "comprehend:ListKeyPhrasesDetectionJobs",
                    "comprehend:DescribeSentimentDetectionJob",
                    "comprehend:DescribeTopicsDetectionJob",
                    "comprehend:StopDominantLanguageDetectionJob",
                    "comprehend:BatchDetectSentiment",
                    "comprehend:StartKeyPhrasesDetectionJob",
                    "comprehend:BatchDetectEntities",
                    "comprehend:BatchDetectKeyPhrases",
                    "comprehend:ListEntitiesDetectionJobs",
                    "comprehend:StopKeyPhrasesDetectionJob",
                    "comprehend:ListDocumentClassificationJobs",
                    "comprehend:DetectSyntax",
                    "comprehend:DescribeEntitiesDetectionJob",
                    "comprehend:StopTrainingDocumentClassifier",
                    "comprehend:ListTagsForResource",
                    "comprehend:DescribeDocumentClassifier",
                    "comprehend:StopEntitiesDetectionJob",
                    "comprehend:BatchDetectDominantLanguage",
                    "comprehend:StartDocumentClassificationJob",
                    "comprehend:DetectEntities",
                    "comprehend:DetectKeyPhrases",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:CreateGrant",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "comprehendAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "comprehendRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "comprehendRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "comprehendRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "comprehendS3Role": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "comprehend.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "s3:ListBucket",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:CreateGrant",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "ComprehendAllowS3",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "contentModerationOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkContentModeration",
            "Arn",
          ],
        },
        "Name": "contentModeration",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startContentModeration",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "contentModerationOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "contentModerationImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startContentModeration",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "faceDetectionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkFaceDetection",
            "Arn",
          ],
        },
        "Name": "faceDetection",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startFaceDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "faceDetectionOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "faceDetectionImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startFaceDetection",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "faceSearchOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "CollectionId": "",
          "Enabled": false,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkFaceSearch",
            "Arn",
          ],
        },
        "Name": "faceSearch",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startFaceSearch",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "faceSearchOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "CollectionId": "",
          "Enabled": false,
          "MediaType": "Image",
        },
        "Name": "faceSearchImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startFaceSearch",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "genericDataLookupLambdaRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
            {
              "id": "AwsSolutions-IAM4",
              "reason": "Managed policies required for IAM role.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/AmazonS3ReadOnlyAccess",
              ],
            ],
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "GenericDataLookupLambdaAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "genericDataLookupLambdaRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
            {
              "id": "AwsSolutions-IAM4",
              "reason": "Managed policies required for IAM role.",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "genericDataLookupLambdaRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "genericDataLookupLambdaRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "getEntityDetection": {
      "DependsOn": [
        "comprehendRoleDefaultPolicy",
        "comprehendRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "get_entity_detection.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "KmsId": {
              "Ref": "referencetoMiTestStackMieKey",
            },
            "OPERATOR_NAME": "comprehendEntityDetection",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "comprehendRole": {
              "Fn::GetAtt": [
                "comprehendS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "get_entity_detection.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "comprehendRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "getKeyPhrases": {
      "DependsOn": [
        "comprehendRoleDefaultPolicy",
        "comprehendRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "get_key_phrases.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "KmsId": {
              "Ref": "referencetoMiTestStackMieKey",
            },
            "OPERATOR_NAME": "comprehendGetKeyPhrases",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "comprehendRole": {
              "Fn::GetAtt": [
                "comprehendS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "get_key_phrases.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "comprehendRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "labelDetectionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkLabelDetection",
            "Arn",
          ],
        },
        "Name": "labelDetection",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startLabelDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "labelDetectionOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "labelDetectionImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startLabelDetection",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "mediaConvertLambdaRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "mediaconvert:GetJob",
                    "mediaconvert:ListJobs",
                    "mediaconvert:DescribeEndpoints",
                    "mediaconvert:CreateJob",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "iam:PassRole",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "mediaConvertS3Role",
                      "Arn",
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                    "kms:Encrypt",
                    "kms:ReEncrypt*",
                    "kms:GenerateDataKey*",
                    "kms:DescribeKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "MediaConvertLambdaAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "mediaConvertLambdaRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "mediaConvertLambdaRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "mediaConvertLambdaRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "mediaConvertS3Role": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Scoped down to S3 Bucket",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "mediaconvert.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                    "kms:Encrypt",
                    "kms:ReEncrypt*",
                    "kms:GenerateDataKey*",
                    "kms:DescribeKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "MediaconvertAllowS3",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "mediainfoLambdaRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
            {
              "id": "AwsSolutions-IAM4",
              "reason": "Managed policies required for IAM role.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/AmazonS3ReadOnlyAccess",
              ],
            ],
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "mediainfoLambdaAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "mediainfoLambdaRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
            {
              "id": "AwsSolutions-IAM4",
              "reason": "Managed policies required for IAM role.",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "mediainfoLambdaRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "mediainfoLambdaRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "personTrackingOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": false,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkPersonTracking",
            "Arn",
          ],
        },
        "Name": "personTracking",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startPersonTracking",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "pollyRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "comprehend.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "polly:SynthesizeSpeech",
                    "polly:StartSpeechSynthesisTask",
                    "polly:ListLexicons",
                    "polly:GetSpeechSynthesisTask",
                    "polly:ListSpeechSynthesisTasks",
                    "comprehend:DetectDominantLanguage",
                    "polly:GetLexicon",
                    "polly:DescribeVoices",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "PollyAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "pollyRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "pollyRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "pollyRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "rekognitionLambdaRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "the policy actions used in this role require * resource",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "the policy actions used in this role require * resource",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "iam:PassRole",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "rekognitionSNSRole",
                      "Arn",
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": [
                    "rekognition:DetectFaces",
                    "rekognition:DetectLabels",
                    "rekognition:DetectText",
                    "rekognition:DetectModerationLabels",
                    "rekognition:GetCelebrityRecognition",
                    "rekognition:GetContentModeration",
                    "rekognition:GetFaceDetection",
                    "rekognition:GetFaceSearch",
                    "rekognition:GetLabelDetection",
                    "rekognition:GetPersonTracking",
                    "rekognition:RecognizeCelebrities",
                    "rekognition:StartCelebrityRecognition",
                    "rekognition:StartContentModeration",
                    "rekognition:StartFaceDetection",
                    "rekognition:StartFaceSearch",
                    "rekognition:StartLabelDetection",
                    "rekognition:StartPersonTracking",
                    "rekognition:StartTextDetection",
                    "rekognition:GetTextDetection",
                    "rekognition:StartSegmentDetection",
                    "rekognition:GetSegmentDetection",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "rekognition:DescribeCollection",
                    "rekognition:SearchFaces",
                    "rekognition:SearchFacesByImage",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":rekognition:",
                        {
                          "Ref": "AWS::Region",
                        },
                        ":",
                        {
                          "Ref": "AWS::AccountId",
                        },
                        ":collection/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "rekognitionAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "rekognitionLambdaRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "the policy actions used in this role require * resource",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "rekognitionLambdaRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "rekognitionLambdaRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "rekognitionSNSRole": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "the policy actions used in this role require * resource",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "the policy actions used in this role require * resource",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "rekognition.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "sns:Publish",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "snsRekognitionTopic",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "RekognitionSNSPublishPolicy",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "shotDetectionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkShotDetection",
            "Arn",
          ],
        },
        "Name": "shotDetection",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startShotDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "snsRekognitionTopic": {
      "Properties": {
        "DisplayName": "SNS Role for Rekognition",
        "KmsMasterKeyId": {
          "Ref": "referencetoMiTestStackMieKeyArn",
        },
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::SNS::Topic",
    },
    "startCelebrityRecognition": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "celebrityRecognition",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_celebrity_recognition",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startContentModeration": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "contentModeration",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_content_moderation",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startEntityDetection": {
      "DependsOn": [
        "comprehendRoleDefaultPolicy",
        "comprehendRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_entity_detection.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "KmsId": {
              "Ref": "referencetoMiTestStackMieKey",
            },
            "OPERATOR_NAME": "comprehendStartEntityDetection",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "comprehendRole": {
              "Fn::GetAtt": [
                "comprehendS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "start_entity_detection.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "comprehendRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startFaceDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "faceDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_face_detection",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startFaceSearch": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_face_search.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "faceSearch",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_face_search.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "MemorySize": 256,
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startGenericDataLookup": {
      "DependsOn": [
        "genericDataLookupLambdaRoleDefaultPolicy",
        "genericDataLookupLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "generic_data_lookup.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataLookupRole": {
              "Fn::GetAtt": [
                "genericDataLookupLambdaRole",
                "Arn",
              ],
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "GenericDataLookup",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "generic_data_lookup.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "genericDataLookupLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startKeyPhrases": {
      "DependsOn": [
        "comprehendRoleDefaultPolicy",
        "comprehendRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_key_phrases.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "KmsId": {
              "Ref": "referencetoMiTestStackMieKey",
            },
            "OPERATOR_NAME": "comprehendStartKeyPhrases",
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
            "comprehendRole": {
              "Fn::GetAtt": [
                "comprehendS3Role",
                "Arn",
              ],
            },
          },
        },
        "Handler": "start_key_phrases.lambda_handler",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "comprehendRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 300,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startLabelDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "labelDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_label_detection",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startPersonTracking": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "OPERATOR_NAME": "personTracking",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_person_tracking",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startShotDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "shotDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_shot_detection",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startTechnicalCueDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "technicalCueDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_technical_cue_detection",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "startTextDetection": {
      "DependsOn": [
        "rekognitionLambdaRoleDefaultPolicy",
        "rekognitionLambdaRole",
      ],
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-L1",
              "reason": "Latest lambda version not supported at this time.",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W89",
              "reason": "This Lambda function does not need to access any resource provisioned within a VPC.",
            },
            {
              "id": "W92",
              "reason": "This function does not require performance optimization, so the default concurrency limits suffice.",
            },
          ],
        },
      },
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Fn::Join": [
              "-",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "RegionalS3Bucket",
                  ],
                },
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
          "S3Key": {
            "Fn::Join": [
              "/",
              [
                {
                  "Fn::FindInMap": [
                    "SourceCode",
                    "General",
                    "CodeKeyPrefix",
                  ],
                },
                "start_rekognition.zip",
              ],
            ],
          },
        },
        "Environment": {
          "Variables": {
            "DATAPLANE_BUCKET": {
              "Ref": "DataPlaneBucket",
            },
            "DataplaneEndpoint": {
              "Ref": "DataPlaneEndpoint",
            },
            "OPERATOR_NAME": "textDetection",
            "REKOGNITION_ROLE_ARN": {
              "Fn::GetAtt": [
                "rekognitionSNSRole",
                "Arn",
              ],
            },
            "REKOGNITION_SNS_TOPIC_ARN": {
              "Ref": "snsRekognitionTopic",
            },
            "botoConfig": {
              "Ref": "Boto3UserAgent",
            },
          },
        },
        "Handler": "start_rekognition.start_text_detection",
        "Layers": [
          {
            "Ref": "referencetoMiTestStackMediaInsightsOnAwsPython311Layer",
          },
        ],
        "Role": {
          "Fn::GetAtt": [
            "rekognitionLambdaRole",
            "Arn",
          ],
        },
        "Runtime": "python3.11",
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
        "Timeout": 120,
        "TracingConfig": {
          "Mode": "PassThrough",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "technicalCueDetectionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkTechnicalCueDetection",
            "Arn",
          ],
        },
        "Name": "technicalCueDetection",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startTechnicalCueDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "textDetectionOperation": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Video",
        },
        "MonitorLambdaArn": {
          "Fn::GetAtt": [
            "checkTextDetection",
            "Arn",
          ],
        },
        "Name": "textDetection",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startTextDetection",
            "Arn",
          ],
        },
        "Type": "Async",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "textDetectionOperationImage": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "Configuration": {
          "Enabled": true,
          "MediaType": "Image",
        },
        "Name": "textDetectionImage",
        "ResourceType": "Operation",
        "ServiceTimeout": "600",
        "ServiceToken": {
          "Ref": "WorkflowCustomResourceArn",
        },
        "StartLambdaArn": {
          "Fn::GetAtt": [
            "startTextDetection",
            "Arn",
          ],
        },
        "Type": "Sync",
      },
      "Type": "Custom::CustomResource",
      "UpdateReplacePolicy": "Delete",
    },
    "transcribeRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "transcribe:GetVocabulary",
                    "transcribe:GetTranscriptionJob",
                    "transcribe:CreateVocabulary",
                    "transcribe:StartStreamTranscription",
                    "transcribe:StartTranscriptionJob",
                    "transcribe:UpdateVocabulary",
                    "transcribe:ListTranscriptionJobs",
                    "transcribe:ListVocabularies",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "TranscribeAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "transcribeRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "transcribeRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "transcribeRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "translateRole": {
      "Metadata": {
        "Comment": "This role contains two policies that provide GetObject permission for DataplaneBucketName. This duplication is necessary in order to avoid a syntax error when the user-specified ExternalBucketArn parameter is empty.",
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
        "cfn_nag": {
          "rules_to_suppress": [
            {
              "id": "W11",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "iam:PassRole",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "translateS3Role",
                      "Arn",
                    ],
                  },
                },
                {
                  "Action": [
                    "translate:GetTerminology",
                    "translate:ListTerminologies",
                    "translate:ImportTerminology",
                    "translate:TranslateText",
                    "translate:DescribeTextTranslationJob",
                    "translate:StartTextTranslationJob",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "logs:CreateLogGroup",
                    "logs:CreateLogStream",
                    "logs:PutLogEvents",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":logs:*:*:*:*",
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "s3:ListBucket",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                      ],
                    ],
                  },
                },
                {
                  "Action": "lambda:InvokeFunction",
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "DataPlaneHandlerArn",
                  },
                },
                {
                  "Action": [
                    "xray:PutTraceSegments",
                    "xray:PutTelemetryRecords",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "TranslateAccess",
          },
        ],
        "Tags": [
          {
            "Key": "environment",
            "Value": "mie",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "translateRoleDefaultPolicy": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "The X-Ray policy uses actions that must be applied to all resources. See https://docs.aws.amazon.com/xray/latest/devguide/security_iam_id-based-policy-examples.html#xray-permissions-resources",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "translateRoleDefaultPolicy",
        "Roles": [
          {
            "Ref": "translateRole",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "translateS3Role": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Scoped down to S3 Bucket",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "translate.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "s3:GetObject",
                    "s3:PutObject",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                        "/*",
                      ],
                    ],
                  },
                },
                {
                  "Action": "s3:GetObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::If": [
                      "AllowAccessToExternalBucket",
                      {
                        "Ref": "ExternalBucketArn",
                      },
                      {
                        "Fn::Join": [
                          "",
                          [
                            "arn:",
                            {
                              "Ref": "AWS::Partition",
                            },
                            ":s3:::",
                            {
                              "Ref": "DataPlaneBucket",
                            },
                            "/*",
                          ],
                        ],
                      },
                    ],
                  },
                },
                {
                  "Action": "s3:ListBucket",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":s3:::",
                        {
                          "Ref": "DataPlaneBucket",
                        },
                      ],
                    ],
                  },
                },
                {
                  "Action": [
                    "kms:Decrypt",
                    "kms:GenerateDataKey",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Ref": "referencetoMiTestStackMieKeyArn",
                  },
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "TranslateAllowS3",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
  },
}
`;
